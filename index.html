<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Image Extractor</title>
    <script type="module" src="https://unpkg.com/pdfjs-dist@2.12.313/build/pdf.js"></script>
</head>
<body>
    <h1>PDF Image Extractor</h1>

    <input type="file" id="fileInput" accept=".pdf" />
    <button onclick="handleFileInput()">Choose Files</button>
    <button onclick="extractImages()">Extract Images</button>

    <script type="module">
        let pdfData;

        window.handleFileInput = async function() {
            const fileInput = document.getElementById('fileInput');
            fileInput.click();

            fileInput.addEventListener('change', async (event) => {
                const selectedFile = event.target.files[0];
                if (selectedFile) {
                    const fileReader = new FileReader();

                    fileReader.onload = (e) => {
                        pdfData = new Uint8Array(e.target.result);
                    };

                    fileReader.readAsArrayBuffer(selectedFile);
                }
            });
        }

        window.extractImages = async function() {
            if (!pdfData) {
                console.error('Please choose a PDF file first.');
                return;
            }

            try {
                const pdf = await pdfjsLib.getDocument(pdfData).promise;
                const totalPages = pdf.numPages;

                for (let pageNumber = 1; pageNumber <= totalPages; pageNumber++) {
                    const page = await pdf.getPage(pageNumber);
                    const viewport = page.getViewport({ scale: 1.0 });

                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    const renderContext = {
                        canvasContext: context,
                        viewport: viewport,
                    };

                    await page.render(renderContext).promise;

                    // Convert the canvas content to a data URL representing a JPEG image
                    const imageDataUrl = canvas.toDataURL('image/jpeg');

                    // Display the image URL (you can save it or do further processing)
                    console.log('Image Data URL for Page', pageNumber, ':', imageDataUrl);
                }
            } catch (error) {
                console.error('Error extracting images:', error);
            }
        }
    </script>
</body>
</html>
