<!DOCTYPE html>
<html>
<head>
  <title>Video with Karaoke-style Subtitles</title>
</head>
<body>
  <video id="video" src="res/mmexport1624376890764.mp4" controls></video>
  <canvas id="canvas"></canvas>

  <script>
    // Video and canvas elements
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

// Text content and font settings
const text = "欢迎来到漂泊者乐园一起交流学习";
const font = "36px Arial";
const fontColor = "rgb(0, 255, 0)"; // Green color
const highlightColor = "rgb(255, 0, 0)"; // Red color

// Calculate the duration in milliseconds for each character
const frameDuration = 700; // 0.7 second duration

// Play the video
video.play();

// Draw the text overlay on each frame
function drawOverlay() {
  // Clear the canvas
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw the video frame on the canvas
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

  // Calculate the current frame index
  const frameIndex = Math.floor(video.currentTime * 1000 / frameDuration);

  // Calculate the position to start drawing the text
  const startX = 50;
  const startY = 350;

  // Set the font style and color
  ctx.font = font;
  ctx.fillStyle = fontColor;

  // Iterate over each character in the text
  for (let i = 0; i < text.length; i++) {
    // Calculate the position for the current character
    const x = startX + (i * ctx.measureText(text[i]).width);
    const y = startY;

    // Set the fill color based on whether the character should be highlighted or not
    ctx.fillStyle = (frameIndex >= i) ? highlightColor : fontColor;

    // Draw the character at the appropriate position
    ctx.fillText(text[i], x, y);
  }

  // Repeat the process on the next frame
  requestAnimationFrame(drawOverlay);
}

// Start drawing the overlay
video.addEventListener('play', () => {
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  drawOverlay();
});
  </script>
</body>
</html>
